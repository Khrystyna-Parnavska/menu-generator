{% extends "base.html" %}
{% block head %}
    <title>Menu</title>
{% endblock %}

{% block body %}
    <h3 style="text-align: center;">Choose meals to add:</h3>
    <form action="{{ url_for('init_plan') }}" method="POST">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 30px;">
            {% for meal in all_meals %}
            <label><input type="checkbox" name="meals" value="{{ meal['name'] }}" checked> {{ meal['name'] }}</label>
            {% endfor %}
        </div> 
        <button type="submit" class="submit-btn">Generate Draft</button>  
    </form>
    {% if error %}
    <p style="color:red; text-align:center;">{{ error }}</p>
    {% endif %}

    {% if menu_meals %}
    <section id="draft" style="margin-top: 40px;">
        <h2 style="text-align: center;">Your Generated Draft</h2>
        <form action="/submit-final-menu" method="POST">
            
            {% for meal_entry in menu_meals %}
            <div class="meal-card">
                <div class="time-badge" style="background: none; padding: 0;">
                <input type="time" 
                    name="meal_time_{{ meal_entry['id'] }}" 
                    value="{{ meal_entry['meal_time'] }}" 
                    class="custom-input"
                    step="60" 
                    style="width: 100px; padding: 5px; border-radius: 8px;">
            </div>
                
                <div>
                    <strong>{{ meal_entry['meal_type'] }}: {{ meal_entry['recipe_name'] }}</strong><br>
                    
                    <label style="font-size: 0.8em;">
                        <input type="hidden" name="meal_ids[]" value="{{ meal_entry['id'] }}">
                        <input type="checkbox" name="leftover_{{ meal_entry['id'] }}"> Use leftovers later
                    </label>
                </div>

                <div class="action-group">
                    <button type="button" class="action-btn">Regenerate</button>
                    <button type="button" class="action-btn">Choose Manually</button>
                </div>
            </div>
            {% endfor %}

            <button type="submit" class="submit-btn" style="width:100%">Submit Menu</button>
        </form>
    </section>
{% endif %}
{% endblock %}


